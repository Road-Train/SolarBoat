<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Boat Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let camera, scene, renderer, boat;
            let boatRotation = 0; // To keep track of boat's rotation

            function init() {
                camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 10);
                camera.position.z = 1;

                scene = new THREE.Scene();

                // Create water surface
                const waterGeometry = new THREE.PlaneGeometry(10, 10);
                const waterMaterial = new THREE.MeshPhongMaterial({ color: 0x3399ff, side: THREE.DoubleSide });
                const water = new THREE.Mesh(waterGeometry, waterMaterial);
                water.rotation.x = -Math.PI / 2;
                scene.add(water);

                // Create the boat using the detailed model
                function createBoat(boatColor) {
                    const boatWidth = 0.36;
                    const boatHeight = 0.1;
                    const boatDepth = 0.1;

                    const boatMaterial = new THREE.MeshLambertMaterial({ color: boatColor });

                    const boat = new THREE.Mesh(new THREE.BoxGeometry(boatWidth, boatHeight, boatDepth), boatMaterial);
                    boat.castShadow = true;

                    boat.position.y = boatHeight / 2;

                    // Create sail
                    const sailVertices = new Float32Array([
                        0, 0, 0,
                        boatWidth + 0.03, 0, 0,
                        boatWidth + 0.03, 0.36, 0,
                        0, 0, 0.01,
                        boatWidth + 0.03, 0, 0.01,
                        boatWidth + 0.03, 0.36, 0.01,
                    ]);
                    const sailIndices = [
                        0, 1, 2,
                        5, 4, 3
                    ];
                    const sailGeometry = new THREE.BufferGeometry();
                    sailGeometry.setAttribute('position', new THREE.BufferAttribute(sailVertices, 3));
                    sailGeometry.setIndex(sailIndices);
                    sailGeometry.computeVertexNormals();

                    const sailMaterial = new THREE.MeshLambertMaterial({ color: 0xffffff });
                    const sail = new THREE.Mesh(sailGeometry, sailMaterial);
                    sail.castShadow = true;
                    sail.position.set(-boatWidth / 2 - 0.08, boatHeight / 2, 0);

                    boat.add(sail);

                    // Create front part
                    const bowVertices = new Float32Array([
                        0, boatHeight / 2, boatDepth / 2,
                        0, -boatHeight / 2, boatDepth / 2,
                        0, boatHeight / 2, -boatDepth / 2,
                        0, -boatHeight / 2, -boatDepth / 2,
                        -0.15, boatHeight / 2, 0
                    ]);
                    const bowIndices = [
                        0, 2, 4,
                        4, 1, 0,
                        4, 3, 1,
                        2, 3, 4
                    ];
                    const bowGeometry = new THREE.BufferGeometry();
                    bowGeometry.setAttribute('position', new THREE.BufferAttribute(bowVertices, 3));
                    bowGeometry.setIndex(bowIndices);
                    bowGeometry.computeVertexNormals();

                    const bow = new THREE.Mesh(bowGeometry, boatMaterial);
                    bow.castShadow = true;
                    bow.position.set(-boatWidth / 2, 0, 0);

                    boat.add(bow);

                    return boat;
                }

                boat = createBoat(0x7f0000); // Create a red boat
                scene.add(boat);

                // Add some lighting to the scene
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
                directionalLight.position.set(0, 1, 1);
                scene.add(directionalLight);

                renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
            }

            function animate() {
                requestAnimationFrame(animate);
                renderer.render(scene, camera);
            }

            function moveBoat(direction) {
                const speed = 0.01; // Adjust speed as needed
                const rotationSpeed = 0.05; // Adjust rotation speed as needed

                switch (direction) {
                    case 'up':
                        boat.position.x -= speed * Math.sin(boatRotation);
                        boat.position.z += speed * Math.cos(boatRotation);
                        break;
                    case 'down':
                        boat.position.x += speed * Math.sin(boatRotation);
                        boat.position.z -= speed * Math.cos(boatRotation);
                        break;
                    case 'left':
                        boatRotation += rotationSpeed;
                        boat.rotation.y = boatRotation;
                        break;
                    case 'right':
                        boatRotation -= rotationSpeed;
                        boat.rotation.y = boatRotation;
                        break;
                    default:
                        break;
                }
            }

            function handleKeyDown(event) {
                switch (event.key) {
                    case 'ArrowUp':
                        moveBoat('up');
                        break;
                    case 'ArrowDown':
                        moveBoat('down');
                        break;
                    case 'ArrowLeft':
                        moveBoat('left');
                        break;
                    case 'ArrowRight':
                        moveBoat('right');
                        break;
                    default:
                        break;
                }
            }

            window.addEventListener('keydown', handleKeyDown);

            init();
            animate();
        });
    </script>
</head>

<body>
</body>

</html>